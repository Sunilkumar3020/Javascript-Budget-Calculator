var budgetController=function(){var c=function(e,t,n){this.id=e,this.description=t,this.value=n,this.percentage=-1};c.prototype.calcPercentage=function(e){this.percentage=0<e?Math.round(this.value/e*100):-1},c.prototype.getPercentage=function(){return this.percentage};var l=function(e,t,n){this.id=e,this.description=t,this.value=n},e=function(e){var t=0;r.allItems[e].forEach(function(e){t+=e.value}),r.totals[e]=t},r={allItems:{exp:[],inc:[]},totals:{exp:0,inc:0},budget:0,percentage:-1};return{addItem:function(e,t,n){var i,a;return a=0<r.allItems[e].length?r.allItems[e][r.allItems[e].length-1].id+1:0,"exp"===e?i=new c(a,t,n):"inc"===e&&(i=new l(a,t,n)),r.allItems[e].push(i),i},deleteItem:function(e,t){var n;-1!==(n=r.allItems[e].map(function(e){return e.id}).indexOf(t))&&r.allItems[e].splice(n,1)},calculateBudget:function(){e("inc"),e("exp"),r.budget=r.totals.inc-r.totals.exp,0<r.totals.inc?r.percentage=Math.round(r.totals.exp/r.totals.inc*100):r.percentage=-1},calculatePercentage:function(){r.allItems.exp.forEach(function(e){e.calcPercentage(r.totals.inc)})},getPercentages:function(){return r.allItems.exp.map(function(e){return e.getPercentage()})},getBudget:function(){return{budget:r.budget,totalInc:r.totals.inc,totalExp:r.totals.exp,percentages:r.percentage}},testing:function(){console.log(r)}}}(),UIController=function(){var c={inputType:".add__type",inputDescription:".add__description",inputValue:".add__value",inputBtn:".add__btn",incomeContainer:".income__list",expenseContainer:".expenses__list",budgetLabel:".budget__value",incomeLabel:".budget__income--value",expenseLabel:".budget__expenses--value",percentageLabel:".budget__expenses--percentage",container:".containers",expensePercLable:".item__percentage"};return{getInput:function(){return{type:document.querySelector(c.inputType).value,description:document.querySelector(c.inputDescription).value,value:parseFloat(document.querySelector(c.inputValue).value)}},addListItem:function(e,t){var n,i,a;"inc"===t?(a=c.incomeContainer,n='<div class="item" id="inc-%id%"><div class="item__description">%description%</div><div class="right"><div class="item__value">%value%</div><div class="item__delete"><button class="item__delete--btn"><i class="fas fa-trash-alt"></i></button></div></div></div>'):"exp"===t&&(a=c.expenseContainer,n='<div class="item" id="exp-%id%"><div class="item__description">%description%</div><div class="right"><div class="item__value">%value%</div><div class="item__percentage">21%</div><div class="item__delete"><button class="item__delete--btn"><i class="fas fa-trash-alt"></i></button></div></div></div>'),i=(i=(i=n.replace("%id%",e.id)).replace("%description%",e.description)).replace("%value%",e.value),document.querySelector(a).insertAdjacentHTML("beforeend",i)},deleteListItems:function(e){var t=document.getElementById(e);t.parentNode.removeChild(t)},clearFields:function(){var e,t;e=document.querySelectorAll(c.inputDescription+","+c.inputValue),(t=Array.prototype.slice.call(e)).forEach(function(e,t,n){e.value=""}),t[0].focus()},displayBudget:function(e){document.querySelector(c.budgetLabel).textContent=e.budget,document.querySelector(c.incomeLabel).textContent=e.totalInc,document.querySelector(c.expenseLabel).textContent=e.totalExp,0<e.percentages?document.querySelector(c.percentageLabel).textContent=e.percentages+"%":document.querySelector(c.percentageLabel).textContent="--"},displayPercentages:function(n){!function(e,t){for(var n=0;n<e.length;n++)t(e[n],n)}(document.querySelectorAll(c.expensePercLable),function(e,t){0<n[t]?e.textContent=n[t]+"%":e.textContent="--"})},getDOMStrings:function(){return c}}}(),controller=function(c,l){var r=function(){c.calculateBudget();var e=c.getBudget();l.displayBudget(e)},o=function(){c.calculatePercentage();var e=c.getPercentages();console.log(e),l.displayPercentages(e)},t=function(){var e,t;""!==(e=l.getInput()).description&&!isNaN(e.value)&&0<e.value&&(t=c.addItem(e.type,e.description,e.value),l.addListItem(t,e.type),l.clearFields()),r(),o()},n=function(e){var t,n,i,a;(t=e.target.parentNode.parentNode.parentNode.parentNode.id)&&(i=(n=t.split("-"))[0],a=parseInt(n[1]),c.deleteItem(i,a),l.deleteListItems(t),r(),o())};return{init:function(){var e;l.displayBudget({budget:0,totalInc:0,totalExp:0,percentages:-1}),e=l.getDOMStrings(),document.querySelector(e.inputBtn).addEventListener("click",t),document.addEventListener("keypress",function(e){13!==e.keyCode&&13!==e.which||t()}),document.querySelector(e.container).addEventListener("click",n)}}}(budgetController,UIController);controller.init();